<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width" />

    <title>Speech color changer</title>

    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <button id="startBtn">Start</button>
    <button id="stopBtn">Stop</button>
    <div>
      <p id="display"></p>
    </div>

    <script>
      const startBtn = document.querySelector("#startBtn");
      const stopBtn = document.querySelector("#stopBtn");
      const result = document.querySelector("#display");
      var SpeechRecognition = SpeechRecognition || webkitSpeechRecognition;
      var SpeechGrammarList = SpeechGrammarList || window.webkitSpeechGrammarList;
      var SpeechRecognitionEvent = SpeechRecognitionEvent || webkitSpeechRecognitionEvent;

      var recognition = new SpeechRecognition();

      // console.log(recognition);

      var colors = [
        "aqua",
        "azure",
        "beige",
        "bisque",
        "black",
        "blue",
        "brown",
        "chocolate",
        "coral",
        "crimson",
        "cyan",
        "fuchsia",
        "ghostwhite",
        "gold",
        "goldenrod",
        "gray",
        "green",
        "indigo",
        "ivory",
        "khaki",
        "lavender",
        "lime",
        "linen",
        "magenta",
        "maroon",
        "moccasin",
        "navy",
        "olive",
        "orange",
        "orchid",
        "peru",
        "pink",
        "plum",
        "purple",
        "red",
        "salmon",
        "sienna",
        "silver",
        "snow",
        "tan",
        "teal",
        "thistle",
        "tomato",
        "turquoise",
        "violet",
        "white",
        "yellow",
      ];

      var speechRecognitionList = new SpeechGrammarList();
      var grammar = "#JSGF V1.0; grammar colors; public <color> = " + colors.join(" | ") + " ;";
      speechRecognitionList.addFromString(grammar, 1);
      recognition.grammars = speechRecognitionList;
      recognition.continuous = true;
      recognition.lang = "en-US";
      recognition.interimResults = true;
      recognition.maxAlternatives = 1;

      startBtn.addEventListener("click", () => {
        recognition.start();
        console.log("LISTENING");
      });

      stopBtn.addEventListener("click", () => {
        console.log("CONTINUOUS LISTENING STOPPED");
        recognition.stop();
      });
      recognition.onresult = (event) => {
        console.log(event.results);
        var noOfPhrases = event.results.length;
        // console.log(noOfPhrases);
        var lastSentence = event.results[noOfPhrases - 1][0].transcript;
        result.innerHTML = result.innerHTML + " " + lastSentence;
      };

      recognition.onspeechend = () => {
        console.log("STOPPED LISTENING");
        recognition.stop();
      };
    </script>
  </body>
</html>
